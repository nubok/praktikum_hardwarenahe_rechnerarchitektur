\documentclass[10pt]{scrbook}
\usepackage[latin1]{inputenc}
\usepackage{bibgerm}
\usepackage[english, ngerman]{babel}
\usepackage[babel]{csquotes}
\usepackage{cite}
\usepackage{amsmath} % for eqref
\usepackage{tabularx}
\author{Denis Dietze\footnote{denis.dietze@st.ovgu.de} \and Wolfgang Keller\footnote{wolfgang.keller@student.uni-magdeburg.de} \and Nico Linke\footnote{nicolinke@googlemail.com} \and Thomas Schulte\footnote{thomas.schulte.md@googlemail.com}}
\title{Protokoll Versuch IT1/E13}
\subtitle{Schnittstellen}

\begin{document}
\maketitle
\tableofcontents
\chapter{Vorbereitungsaufgaben}

\section{Baugruppen eines Rechners}

\subsection{Frage} Aus welchen Baugruppen besteht ein Rechner ähnlich der von-Neumann-Architektur,
wie sind sie verbunden, und wie erfolgt die Kommunikation mit der Peripherie?

\section{Aufgabe von Schnittstellen}

\subsection{Frage} Welche Aufgabe haben Schnittstellen im Rechner?

\subsection{Antwort}
Schnittstellen dienen zum Anschluss von Peripherieger"aten.

\section{Datenaustausch über eine parallele Schnittstelle mit
Handshaking}

\subsection{Frage} Wie funktioniert ein Datenaustausch über eine parallele Schnittstelle mit
Handshaking?

\subsection{Antwort}
Die konkreten Details des Austausch h"angen davon, in welchem Modus der Parallelport betrieben wird. Daher beschr"anken wir uns in der Beschreibung auf den Fall der .

Laut \cite[S.~447-448]{Baehring} beginnt die "Ubertragung "uber die Centronics-Schnittstelle damit, dass der Prozessor ein Ausgabedatum auf auf die Ausg"ange \verb|DATA1|-\verb|DATA8| der Schnittstelle schaltet. Fr"uhestens $0,5 \mu{}s$ sp"ater wird das \verb|STROBE|-Signal aktiviert, um das Vorliegen eines g"ultigen Datums anzuzeigen.

Anschließend kann das Ger"at die Daten entweder annehmen oder durch Aktivieren eines \verb|BUSY|-Signals anzeigen, dass es besch"aftigt ist. Wenn es bereit ist die Daten anzunehmen, deaktiviert es das \verb|BUSY|-Signal und quittiert die Datenannahme durch ein mindestens $0,5 \mu{}s$ langes \verb|ACKNLG|-Signal.

In \cite[S.~9]{PreussMusa} wird weiter zwischen einem \emph{Dreidraht-Handshake-Protokoll}, was dem soeben Beschriebenen entspricht und einem \emph{Zweidraht-Handshake-Protokoll} unterschieden.

In letzterem bleibt beim Anlegen der Daten auf den Datenleitungen die \verb|STROBE|-Leitung so lange aktiviert, bis der Rechner ein Signal auf der \verb|ACKNOWLEDGE|-Leitung empf"angt. Dieses setzt das \verb|STROBE|-Signal zur"uck und das Peripherieger"at kann neue Daten empfangen.

\section{Funktionsweise einer seriellen Datenübertragung}

\subsection{Frage} Wie funktioniert eine serielle Datenübertragung?

\subsection{Antwort}

\section{Das Prinzip der Stromschleife}

\subsection{Frage} Erläutern Sie das Prinzip der Stromschleife! Was ist der Vorteil gegenüber einer
spannungsbasierten Übertragung?

\subsection{Antwort}

Die Stromschleife besteht aus einer aktiven (meist PC) und passiven (meist Peripherieger"at) Seite. Wie im Bild in Abschnitt 2.1.2 der Versuchsanleitung zu sehen, wird ein Strom von $20~mA$ "uber diese gesendet, wenn eine logische 1 "ubertragen wird und kein Strom, wenn eine logische 0 "ubertragen wird. Auf der passiven Seite wird durch einen Optokoppler bzw. Relais das Signal ausgewertet.

Der Vorteil gegen"uber einer spannungsbasierten "Ubertragung besteht darin, dass nicht beachtet werden muss, ob die beiden Seite unterschiedliche elektrische Potentiale besitzen, da Sender und Empf"anger voneinander isoliert sind.

\section{Merkmale des PPI 8255}

\subsection{Frage} Nennen Sie wesentliche Merkmale des PPI 8255! Wie funktionieren die
Betriebsarten?

\section{Interruptverarbeitung im PC}

\subsection{Frage} Wie ist die Interruptverarbeitung im PC organisiert? Wie sind CPU,
Interruptcontroller und -quellen miteinander verschaltet? Wie funktioniert
Vektorinterrupt?

\section{Hardware- vs. Software-Interrupts}

\subsection{Frage}
Was unterscheidet Hardware- von Software-Interrupts, was haben sie gemeinsam?

\subsection{Antwort}
Hardware-Interrupts werden durch ein Peripherie-Ger"at ausgel"ost, w"ahrend Software-Interrupts durch einen \verb|INT|-Befehl ausgel"ost werden.

In beiden F"allen wird der Wert des Stack Pointers \verb|SP| auf dem Stack gesichert und der dem Interrupt zugeh"orige Wert aus der Interrupt-Einsprungtabelle in den Program Counter \verb|PC| geladen.

Somit stellen Software-Interrupts eine Art Funktionsaufruf dar, w"ahrend Hardware-Interrupts eine asynchrone Unterbrechung des Programmablaufs darstellen.

\section{M"oglichkeiten der Schnittstellenkonfigurierung}

\subsection{Frage} Informieren Sie sich über M"oglichkeiten der Schnittstellenkonfigurierung. Welche
Rolle spielen dabei Softwareinterrupts?

\subsection{Antwort}

\section{Befehle zum Zugriff auf Ein-/Ausgabe-Baugruppen}

\subsection{Frage} Wiederholen Sie die Syntax des 80x86-Assemblers (siehe Anlage 12 der Versuchsanleitung). Mit welchen
Befehlen wird auf die Ein-/Ausgabe-Baugruppen zugegriffen?

\subsection{Antwort} Die Befehle zum Zugriff auf Ports sind \verb|IN| zum Einlesen und \verb|OUT| zum Ausgeben eines Wertes aus einem Port. Außerdem sind viele Baugruppen unter DOS "uber Interrupts ansteuerbar, wie in Anlagen 3-5 der Versuchsanleitung bez"uglich Interrupt 14h, 15h bzw. 21h f"ur die serielle bzw. parallele Schnittstelle. In diesem Fall erfolgt der Zugriff durch Belegen der Prozessorregister mit den gew"unschten Werten gefolgt von einem \verb|INT|-Befehl.

\chapter{Aufgaben und Auswertung}

\section{Aufgabe 1a}

\paragraph{Aufgabenstellung} Ab Adresse Segment:Offset=0:410h speichert das Betriebssystem das
Systemkonfigurations-Wort (16 Bit) ab. Bits 15 und 14 enthalten die Anzahl der
parallelen und Bits 9 und 10 die Anzahl der seriellen Ports. Ab Adresse 0:400h stehen die
Basisadressen von COM1 und COM2 und ab Adresse 0:408h die Basisadressen von
LPT1-3 (jeweils 16 Bit). Zeigen Sie die Werte mit <d> an. Notieren Sie sich die Werte.

\paragraph{Durchf"uhrung} Alle folgenden Ausgaben notieren:

\begin{verbatim}
d0:410 l 2 (Systemkonfigurations-Wort)
\end{verbatim}

\paragraph{Auswertung}
\begin{itemize}
\item Bit 1, 2 von 0:411h (Bit 9, 10 des Systemkonfigurations-Worts): Anzahl serieller Ports
\item Bit 7, 8 von 0:411h (Bit 14, 15 des Systemkonfigurations-Worts): Anzahl paralleler Ports
\end{itemize}

\begin{verbatim}
d0:400 l 2 (Basisadresse COM1)

d0:402 l 2 (Basisadresse COM2)

d0:408 l 2 (Basisadresse LPT1)

d0:40A l 2 (Basisadresse LPT2)

d0:40C l 2 (Basisadresse LPT3)
\end{verbatim}

\section{Aufgabe 1b}

\paragraph{Aufgabenstellung} Auf welcher Speicheradresse befindet sich der Interruptvektor von IRQ 7 und welchen
Wert hat er? Vergleichen Sie den Wert, wie er mit 'si' angezeigt wird, mit der Anzeige in
'debug'. Lassen Sie sich die Interrupt-Serviceroutine als Assemblercode anzeigen
(Befehl \textless u\textgreater ).

\paragraph{Durchf"uhrung} Laut Tabelle 9 der Versuchsanleitung hat IRQ 7 die Nummer INT 0F. Da die Interruptvektortabelle an an der Adresse 0:0 beginnt und jeder Eintrag vier Bytes lang ist, liegt der Interruptvektor von IRQ 7 an der Speicheradresse \verb|3C|.

Um den Wert anzuzeigen, benutzen wir also

\begin{verbatim}
d0:3C l 4
\end{verbatim}

Ausgabe ist in Segment:Offset (also Segment [d0:3F][d0:3E], Offset [d0:3D][d0:3C]).

\paragraph{Vermutung} In 'si' wird es
\begin{itemize}
\item als direkte Speicheradresse (Segment*10h+Offset)
\item in Big-Endian-Schreibweise
\end{itemize}
dargestellt.

Um den Assemblercode anzuzeigen, benutzen wir
\begin{verbatim}
U Segment:Offset
\end{verbatim}

\section{Aufgabe 2}

\paragraph{Aufgabenstellung} Initialisieren Sie den PPI 8255 der E/A-Karte PIO-12 im Mode 1 (Portadressen siehe
Anlagen 6 und 8) für Byteeingabe Port A, Byteausgabe Port B mit Handshaking-
Protokoll an Port C. Ermitteln Sie die notwendigen Steuerworte anhand Anlage 7 und
geben Sie diese mit Hilfe des DOS-Debuggers auf die Steuerwortaderesse des PPI aus
(Befehlsübersicht in Anlage 2). Simulieren Sie einen asynchronen Datenaustausch mit
Hilfe der Leuchtdioden und Schalter des Steuerpults, indem Sie mit dem Debugger Einund
Ausgaben durchführen. Stellen Sie das Signalspiel auf dem Digitaloszilloskop dar
(Digitalmodus, Ablenkung ca. 1-2 s).


\paragraph{Durchf"uhrung}
Um auf Mode 1 mit den gew"unschten Eigenschaften zu wechseln, m"ussen wir das Control Word auf \verb|1011?10?| setzen. Da das Steuerwort die Adresse \verb|303h| (?) hat, ergibt sich somit:

\begin{verbatim}
e0:303 ...
\end{verbatim}

\bibliography{E13}{}
\bibliographystyle{geralpha}

\end{document}